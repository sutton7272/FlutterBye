import{r as n,b as z,aT as H,c as E,d as K,j as e,T as Q,i as R,k as w,n as p,C as d,e as j,f as u,W as $,g as v,a as o,aG as l,I as x,h as r,aw as S,ba as J,E as G,B as F,a6 as O,aj as V,ae as X,b3 as Y,b4 as Z,b5 as M,b6 as h,b7 as _,b8 as m}from"./index-CeACcdR0.js";import{K as ee}from"./key-I2paB0_o.js";function te(){const[c,I]=n.useState(!1),[N,P]=n.useState(""),[b,T]=n.useState(""),[y,L]=n.useState(""),[g,W]=n.useState(""),{toast:t}=z(),k=H(),{data:a}=E({queryKey:["/api/escrow-wallets/active"]});E({queryKey:["/api/admin/escrow-wallets"]});const f=K({mutationFn:async s=>{const i=await fetch("/api/escrow-wallets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok)throw new Error("Failed to create wallet");return i.json()},onSuccess:()=>{t({title:"Escrow Wallet Created",description:"New escrow wallet created successfully"}),k.invalidateQueries({queryKey:["/api/escrow-wallets/active"]}),P(""),T("")},onError:s=>{t({title:"Creation Failed",description:s.message,variant:"destructive"})}}),C=K({mutationFn:async s=>{const i=await fetch(`/api/escrow-wallets/${s.walletId}/balance`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({balance:s.balance})});if(!i.ok)throw new Error("Failed to update balance");return i.json()},onSuccess:()=>{t({title:"Balance Updated",description:"Wallet balance updated successfully"}),k.invalidateQueries({queryKey:["/api/escrow-wallets/active"]}),W("")},onError:s=>{t({title:"Update Failed",description:s.message,variant:"destructive"})}}),D=()=>{if(!N||!b){t({title:"Missing Information",description:"Please enter both wallet address and private key",variant:"destructive"});return}f.mutate({walletAddress:N,privateKey:b})},U=()=>{if(!y||!g){t({title:"Missing Information",description:"Please select a wallet and enter a balance",variant:"destructive"});return}C.mutate({walletId:y,balance:g})},A=s=>{navigator.clipboard.writeText(s),t({title:"Copied",description:"Copied to clipboard"})},B=s=>`${s.slice(0,6)}...${s.slice(-4)}`,q=s=>c?s:"*".repeat(32);return e.jsx("div",{className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Wallet Management"}),e.jsx("p",{className:"text-xl text-purple-200",children:"Manage escrow wallets and payment processing for Flutterbye"})]}),e.jsxs(Q,{defaultValue:"active",className:"w-full",children:[e.jsxs(R,{className:"grid w-full grid-cols-4",children:[e.jsx(w,{value:"active",children:"Active Wallet"}),e.jsx(w,{value:"create",children:"Create Wallet"}),e.jsx(w,{value:"manage",children:"Manage Balances"}),e.jsx(w,{value:"all",children:"All Wallets"})]}),e.jsx(p,{value:"active",children:e.jsxs(d,{className:"bg-white/10 backdrop-blur-sm border-white/20",children:[e.jsxs(j,{children:[e.jsxs(u,{className:"text-white flex items-center gap-2",children:[e.jsx($,{className:"h-6 w-6"}),"Active Escrow Wallet"]}),e.jsx(v,{className:"text-purple-200",children:"Primary wallet for handling escrowed value and payments"})]}),e.jsx(o,{children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-white",children:"Wallet Address"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{value:a.walletAddress,readOnly:!0,className:"bg-white/10 border-white/20 text-white font-mono"}),e.jsx(r,{size:"sm",variant:"outline",onClick:()=>A(a.walletAddress),children:e.jsx(S,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-white",children:"Total Balance"}),e.jsxs("div",{className:"text-2xl font-bold text-green-300",children:[a.totalBalance," SOL"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-white",children:"Private Key"}),e.jsx(r,{size:"sm",variant:"ghost",onClick:()=>I(!c),children:c?e.jsx(J,{className:"h-4 w-4"}):e.jsx(G,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{value:q(a.privateKey),readOnly:!0,type:c?"text":"password",className:"bg-white/10 border-white/20 text-white font-mono"}),c&&e.jsx(r,{size:"sm",variant:"outline",onClick:()=>A(a.privateKey),children:e.jsx(S,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{variant:"secondary",className:"bg-green-600 text-white",children:[e.jsx(O,{className:"h-3 w-3 mr-1"}),"Active"]}),e.jsxs("span",{className:"text-sm text-gray-300",children:["Created: ",new Date(a.createdAt).toLocaleDateString()]})]})]}):e.jsx("div",{className:"text-center py-8 text-purple-200",children:"No active escrow wallet found. Create one to start processing payments."})})]})}),e.jsx(p,{value:"create",children:e.jsxs(d,{className:"bg-white/10 backdrop-blur-sm border-white/20",children:[e.jsxs(j,{children:[e.jsxs(u,{className:"text-white flex items-center gap-2",children:[e.jsx(ee,{className:"h-6 w-6"}),"Create Escrow Wallet"]}),e.jsx(v,{className:"text-purple-200",children:"Add a new Solana wallet for escrow and payment processing"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"wallet-address",className:"text-white",children:"Wallet Address"}),e.jsx(x,{id:"wallet-address",placeholder:"Enter Solana wallet address",value:N,onChange:s=>P(s.target.value),className:"bg-white/10 border-white/20 text-white placeholder:text-gray-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"private-key",className:"text-white",children:"Private Key"}),e.jsx(x,{id:"private-key",type:"password",placeholder:"Enter private key (will be encrypted)",value:b,onChange:s=>T(s.target.value),className:"bg-white/10 border-white/20 text-white placeholder:text-gray-400"})]}),e.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/50 rounded-lg p-4",children:e.jsxs("p",{className:"text-yellow-200 text-sm",children:[e.jsx(O,{className:"h-4 w-4 inline mr-1"}),"Private keys are encrypted and stored securely. Only use wallets dedicated to escrow operations."]})}),e.jsx(r,{onClick:D,disabled:f.isPending,className:"w-full bg-purple-600 hover:bg-purple-700",children:f.isPending?"Creating...":"Create Escrow Wallet"})]})]})}),e.jsx(p,{value:"manage",children:e.jsxs(d,{className:"bg-white/10 backdrop-blur-sm border-white/20",children:[e.jsxs(j,{children:[e.jsxs(u,{className:"text-white flex items-center gap-2",children:[e.jsx(V,{className:"h-6 w-6"}),"Update Wallet Balance"]}),e.jsx(v,{className:"text-purple-200",children:"Manually update wallet balances after blockchain transactions"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"wallet-select",className:"text-white",children:"Select Wallet"}),e.jsxs("select",{id:"wallet-select",value:y,onChange:s=>L(s.target.value),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-md text-white",children:[e.jsx("option",{value:"",children:"Select a wallet"}),a&&e.jsxs("option",{value:a.id,children:[B(a.walletAddress)," (Active)"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"new-balance",className:"text-white",children:"New Balance (SOL)"}),e.jsx(x,{id:"new-balance",type:"number",step:"0.000000001",placeholder:"0.000000000",value:g,onChange:s=>W(s.target.value),className:"bg-white/10 border-white/20 text-white placeholder:text-gray-400"})]}),e.jsxs(r,{onClick:U,disabled:C.isPending,className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),C.isPending?"Updating...":"Update Balance"]})]})]})}),e.jsx(p,{value:"all",children:e.jsxs(d,{className:"bg-white/10 backdrop-blur-sm border-white/20",children:[e.jsxs(j,{children:[e.jsx(u,{className:"text-white",children:"All Escrow Wallets"}),e.jsx(v,{className:"text-purple-200",children:"Complete list of escrow wallets in the system"})]}),e.jsx(o,{children:a?e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsxs(M,{children:[e.jsx(h,{className:"text-white",children:"Address"}),e.jsx(h,{className:"text-white",children:"Balance"}),e.jsx(h,{className:"text-white",children:"Status"}),e.jsx(h,{className:"text-white",children:"Created"}),e.jsx(h,{className:"text-white",children:"Actions"})]})}),e.jsx(_,{children:e.jsxs(M,{children:[e.jsx(m,{className:"text-white font-mono",children:B(a.walletAddress)}),e.jsxs(m,{className:"text-green-300 font-semibold",children:[a.totalBalance," SOL"]}),e.jsx(m,{children:e.jsx(F,{variant:"secondary",className:"bg-green-600 text-white",children:"Active"})}),e.jsx(m,{className:"text-white",children:new Date(a.createdAt).toLocaleDateString()}),e.jsx(m,{children:e.jsx(r,{size:"sm",variant:"outline",onClick:()=>A(a.walletAddress),children:e.jsx(S,{className:"h-4 w-4"})})})]})})]}):e.jsx("div",{className:"text-center py-8 text-purple-200",children:"No escrow wallets configured"})})]})})]}),e.jsx(d,{className:"bg-gradient-to-r from-green-600/20 to-blue-600/20 backdrop-blur-sm border-white/20",children:e.jsxs(o,{className:"py-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Payment & Escrow Access"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-300",children:[(a==null?void 0:a.totalBalance)||"0"," SOL"]}),e.jsx("div",{className:"text-sm text-gray-300",children:"Available Balance"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-300",children:"Encrypted"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Private Key Security"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-300",children:"Ready"}),e.jsx("div",{className:"text-sm text-gray-300",children:"Payment Processing"})]})]})]})})]})})}export{te as WalletManagementPage};
